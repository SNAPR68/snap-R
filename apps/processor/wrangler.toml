name = "snapr-processor"
main = "src/index.ts"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# Development environment (local)
[env.dev]
vars = { ENVIRONMENT = "development" }

# Staging environment
[env.staging]
vars = { ENVIRONMENT = "staging" }

# Production environment
[env.production]
vars = { ENVIRONMENT = "production" }

# Queue binding (for producing messages)
[[queues.producers]]
binding = "SNAPR_QUEUE"
queue = "snapr-processing-queue"

# R2 bucket for processed images
[[r2_buckets]]
binding = "IMAGES"
bucket_name = "snapr-images"

# KV namespace for checkpoints/resume
[[kv_namespaces]]
binding = "CHECKPOINTS"
id = "local"
